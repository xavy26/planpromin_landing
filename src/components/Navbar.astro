---
import siteData from "../data/site.json";

const pn = Astro.url.pathname;
const isHome = pn === "/";
const site = Astro.site;
const servLink = isHome ? "#services" : `${site}#services`;
const abtLink = isHome ? "#about" : `${site}#about`;
const mapLink = isHome ? "#map" : `${site}#map`;
const regLink = isHome ? "#register" : `${site}#register`;
---

<nav
  class="flex flex-col z-50 fixed sm:flex-row w-full justify-between items-center px-4 sm:px-6 py-1 bg-green-950 shadow-none transition-colors duration-500"
>
  <div
    class="w-full sm:w-auto self-start sm:self-center flex flex-row sm:flex-none flex-no-wrap justify-between items-center"
  >
    <a href={Astro.site} class="no-underline">
      <img src="img/logo.svg" alt={siteData.title} class="h-12 py-1" />
    </a>
    <h2 class="relative block p-4 lg:p-6 text-xl text-white font-bold">
      {siteData.title}
    </h2>
    <button
      id="menuBtn"
      class="hamburger block sm:hidden focus:outline-none"
      type="button"
      onclick="navToggle();"
      aria-label="Show Menu"
    >
      <span class="hamburger__top-bun" style="color: white;"></span>
      <span class="hamburger__bottom-bun"></span>
    </button>
  </div>
  <div
    id="menu"
    class="w-full sm:w-auto self-end sm:self-center hidden sm:flex flex-col sm:flex-row items-center h-full py-1 pb-4 sm:py-0 sm:pb-0"
  >
    <a
      class="text-white font-bold hover:text-purple-600 text-lg text-center w-full no-underline sm:w-auto sm:pr-4 py-2 sm:py-1"
      href={servLink}>Servicios</a
    >
    <a
      class="text-white font-bold hover:text-purple-600 text-lg text-center w-full no-underline sm:w-auto sm:px-4 py-2 sm:py-1"
      href={abtLink}>Quienes somos</a
    >
    <a
      class="text-white font-bold hover:text-purple-600 text-lg text-center w-full no-underline sm:w-auto sm:px-4 py-2 sm:py-1"
      href={abtLink}>Material de proceso</a
    >
    <a
      class="text-white font-bold hover:text-purple-600 text-lg text-center w-full no-underline sm:w-auto sm:px-4 py-2 sm:py-1"
      href={mapLink}>Nuestros proyectos</a
    >
    <a
      class="text-white font-bold hover:text-purple-600 text-lg text-center w-full no-underline sm:w-auto sm:px-4 py-2 sm:py-1"
      href={regLink}>Contactanos</a
    >
  </div>
  <div class="inline-flex pr-10 sm:pr-0" id="main_menu">
    <ul class="flex flex-wrap p-1 md:p-2 text-sm md:text-base" id="menu_nav">
      <li class="relative mx-1 px-1 py-2 group mb-1 md:mb-0" id="button_admin">
        <a class="font-semibold text-white hover:text-purple-600">
          <span class="firstlevel">Idioma</span>
        </a>
        <ul
          class="absolute left-0 top-0 mt-10 p-2 rounded-lg shadow-lg bg-white z-10 hidden group-hover:block"
        >
          <li
            class="p-1 whitespace-no-wrap rounded-full text-sm md:text-base text-gray-600 hover:text-purple-600 hover:bg-gray-100"
          >
            <a class="px-2 py-1">
              <span class="">Español</span>
            </a>
          </li>
          <li
            class="p-1 whitespace-no-wrap rounded-full text-sm md:text-base text-gray-600 hover:text-purple-600 hover:bg-gray-100"
          >
            <a class="px-2 py-1">
              <span class="">Ingles</span>
            </a>
          </li>
          <li
            class="p-1 whitespace-no-wrap rounded-full text-sm md:text-base text-gray-600 hover:text-purple-600 hover:bg-gray-100"
          >
            <a class="px-2 py-1">
              <span class="">Portuges</span>
            </a>
          </li>
        </ul>
      </li>
    </ul>
  </div>
</nav>

<script>
  export default {
    navColor: "bg-transparent", // Color de fondo inicial del nav

    // Función para cambiar el color de fondo del nav cuando se desplaza
    changeNavColor() {
      const nav = document.querySelector("nav");
      if (nav) {
        const scrollPosition = window.scrollY;

        if (scrollPosition > 0) {
          nav.classList.remove(this.navColor);
          nav.classList.add("bg-green-950"); // Cambia al color deseado
          this.navColor = "bg-green-950";
        } else {
          nav.classList.remove(this.navColor);
          nav.classList.add("bg-transparent"); // Vuelve al color inicial
          this.navColor = "bg-transparent";
        }
      }
    },

    onMount() {
      this.changeNavColor(); // Llama a la función cuando se monta el componente
      window.addEventListener("scroll", this.changeNavColor);
    },

    onDestroy() {
      // Remueve el listener del evento de desplazamiento cuando el componente se desmonta
      window.removeEventListener("scroll", this.changeNavColor);
    },
  };
</script>
